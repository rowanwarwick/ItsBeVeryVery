# Распознавание деталей/узлов на участке

1. [Тренировка модели](#тренировка-модели)
2. [Создание мобильного приложения](#создание-мобильного-приложения)


## Тренировка модели

### 1. Подготовка данных
Прежде чем начать тренировку модели, необходимо подготовить набор данных, который будет использоваться для обучения. Набор данных должен содержать изображения объектов, которые нужно распознавать, и соответствующие разметки (метки классов).

### 2. Создание Google Colab Notebook
Google Colab предоставляет бесплатный доступ к вычислительным ресурсам GPU, что делает его отличным выбором для тренировки глубоких нейронных сетей. Вам нужно создать новый ноутбук в Colab.
Зайдите на https://colab.research.google.com/ и создайте новый ноутбук или загрузите существующий.

### 3. Установка PyTorch
Установить PyTorch в среде выполнения.

### 4. Загрузка и предобработка данных. 
Загрузить набор данных в Colab. Можно использовать Google Drive для хранения данных и монтирования его в Colab, чтобы упростить доступ к данным. Затем скопируем данные из Google Drive в рабочую директорию Colab.

### 5. Создание модели
Создаем свою модель для распознавания объектов. Можете использовать предварительно обученные модели и настроить их под свои нужды или создать модель с нуля. В данном случаем тренировка проводилась "с нуля"

### 6. Обучение модели
Разделить набор данных на тренировочную и тестовую выборки и обучаем модель с использованием выбранного оптимизатора и функции потерь.

### 7. Оценка модели
После обучения модели оцениваем ее производительность на тестовой выборке. Используем метрики.

### 8. Экспорт модели
Сохраняем ее для дальнейшего использования. В данном случае подгружаем таковую в рабочем коде мобильного приложения.

### 9. Заключение
Эти шаги предоставляют общий план для тренировки модели для определения предметов с камеры в Google Colab с использованием PyTorch.

В текущем репозитории расположен блокнот `notebook/detail_class_pytorch.ipynb`, по которому непосредственно проходила тренировка модели 

## Создание мобильного приложения

Мобильное приложение написано в IDE Android Studio Flamingo | 2022.2.1 Patch 2 на языке программирования Kotlin

Помимо заранее обученной модели, в числе основных компонентов можно выделить использование зависимостей `CameraX` для определения деталей и узлов с помощью камеры в режиме реального времени.

Использование заранее обученой модели внутри программного кода приложения добавляем приложению независимости от сети интернет.

Для того, чтобы была возможность использовать обученную модель PyTorch, были подключены зависимости `pytorch_android`

В приложении реализовано:

#### 1. Запрос разрешения на пользование камерой

#### 2. Использование `ProcessCameraProvider` для получения потока видео из режима препросмотра камеры

#### 3. Использование `ImageAnalysis` для анализа изображения с целью определения деталей и узлов

#### 4. Трансляция видеопотока реализована во `PreviewView`, которую можно использовать благодаря подгрузке `CameraX`

#### 5. В качетве результата получаем класс с наибольшей вероятностью

#### 6. Старт работы "сканирования" по кнопке

#### 7. По определения детали или узла можно просмотреть подробную информацию о ней с открытием чертежа, если таковой имеется

В текущем репозитории расположен проект `Family21`, который является исходным кодом для инсталяции приложения.

Данное приложение тестировалось на телефоне `Redmi Note 10S` с операционной системой `Android 11` (API 30)
